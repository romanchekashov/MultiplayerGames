<html>
<script>
  Promise.delay = time_ms => new Promise(resolve => setTimeout(resolve, time_ms));

  async function main() {
    const url = 'https://game.look.ovh:4433/counter';
    const transport = new WebTransport(url);

    // Optionally, set up functions to respond to
    // the connection closing:
    transport.closed.then(() => {
        console.log(`The HTTP/3 connection to ${url} closed gracefully.`);
    }).catch((error) => {
        console.error(`The HTTP/3 connection to ${url} closed due to ${error}.`);
    });

    // Once .ready fulfills, the connection can be used.
    await transport.ready;

    // Read datagrams from the server.
    const reader = transport.datagrams.readable.getReader();
    while (true) {
        const {value, done} = await reader.read();
        if (done) {
            break;
        }
        // value is a Uint8Array.
        console.log(value);
    }
  }

  main();
</script>
</html>